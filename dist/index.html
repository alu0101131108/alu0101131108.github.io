<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Egg OOP Parser</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.f1456810.css" as="style"><link rel="preload" href="/assets/js/app.f1edcd29.js" as="script"><link rel="preload" href="/assets/js/2.2c19e274.js" as="script"><link rel="preload" href="/assets/js/7.85245bc6.js" as="script"><link rel="prefetch" href="/assets/js/3.79b60fea.js"><link rel="prefetch" href="/assets/js/4.0d8f90e9.js"><link rel="prefetch" href="/assets/js/5.5f81c412.js"><link rel="prefetch" href="/assets/js/6.2f3f3a69.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f1456810.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" aria-current="page" class="home-link router-link-exact-active router-link-active"><!----> <span class="site-name">Egg OOP Parser</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/docspath.html" class="nav-link">
  Docs
</a></div><div class="nav-item"><a href="/coveragepath.html" class="nav-link">
  Coverage
</a></div><div class="nav-item"><a href="https://v1.vuepress.vuejs.org" target="_blank" rel="noopener noreferrer" class="nav-link external">
  VuePress
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/ULL-ESIT-PL-2122/egg-oop-parser-sebastian-tamayo-guzman-alu0101131108.git" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docspath.html" class="nav-link">
  Docs
</a></div><div class="nav-item"><a href="/coveragepath.html" class="nav-link">
  Coverage
</a></div><div class="nav-item"><a href="https://v1.vuepress.vuejs.org" target="_blank" rel="noopener noreferrer" class="nav-link external">
  VuePress
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/ULL-ESIT-PL-2122/egg-oop-parser-sebastian-tamayo-guzman-alu0101131108.git" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <!----> </aside> <main aria-labelledby="main-title" class="home"><header class="hero"><!----> <h1 id="main-title">
      Egg OOP Parser
    </h1> <p class="description">
      Welcome to your VuePress site
    </p> <!----></header> <!----> <div class="theme-default-content custom content__default"><h1 id="objetivo"><a href="#objetivo" class="header-anchor">#</a> Objetivo</h1> <p>Se pretende construir un módulo con la utilidad de parsear código Egg. Para esto se hace uso del módulo
lexer-generator realizado anteriormente, que exporta una función capaz de construir un analizador léxico
a partir de un array de expresiones regulares asociadas a tipos de tokens.</p> <h1 id="archivos-principales"><a href="#archivos-principales" class="header-anchor">#</a> Archivos principales</h1> <h2 id="tokens-js"><a href="#tokens-js" class="header-anchor">#</a> tokens.js</h2> <p>En este archivo se definen las expresiones regulares que aceptan los distintos tipos de tokens válidos
en el analizador léxico. Estos son utilizados en lex-pl.js a continuación.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token constant">SPACE</span> <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(?&lt;SPACE&gt;\s+|#.*|\/[*](?:.|\n)*?[*]\/)</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span> <span class="token constant">SPACE</span><span class="token punctuation">.</span>skip <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">NUMBER</span> <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(?&lt;NUMBER&gt;[-+]?\d+(\.\d+)?(?:[eE][-+]?\d+)?)</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span> <span class="token constant">NUMBER</span><span class="token punctuation">.</span><span class="token function-variable function">value</span> <span class="token operator">=</span> <span class="token parameter">x</span> <span class="token operator">=&gt;</span> <span class="token function">Number</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">const</span> <span class="token constant">STRING</span> <span class="token operator">=</span>  <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(?&lt;STRING&gt;&quot;(?:[^&quot;\\]|\\.)*&quot;)</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">LP</span> <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(?&lt;LP&gt;\()</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">RP</span> <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(?&lt;RP&gt;\))</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">LB</span> <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(?&lt;LB&gt;\[)</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">RB</span> <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(?&lt;RB&gt;\])</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">LC</span> <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(?&lt;LC&gt;\{)</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">RC</span> <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(?&lt;RC&gt;\})</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">DOT</span> <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(?&lt;DOT&gt;\.)</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">COLON</span> <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(?&lt;COLON&gt;:)</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">WORD</span> <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(?&lt;WORD&gt;[^\s(),&quot;\[\]\.:]+)</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">COMMA</span> <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(?&lt;COMMA&gt;,)</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>

<span class="token comment">/** Tokens object: definitions */</span>
<span class="token keyword">const</span> tokens <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token constant">SPACE</span><span class="token punctuation">,</span><span class="token constant">NUMBER</span><span class="token punctuation">,</span><span class="token constant">STRING</span><span class="token punctuation">,</span><span class="token constant">LP</span><span class="token punctuation">,</span><span class="token constant">RP</span><span class="token punctuation">,</span><span class="token constant">LB</span><span class="token punctuation">,</span><span class="token constant">RB</span><span class="token punctuation">,</span><span class="token constant">LC</span><span class="token punctuation">,</span><span class="token constant">RC</span><span class="token punctuation">,</span><span class="token constant">DOT</span><span class="token punctuation">,</span><span class="token constant">COLON</span><span class="token punctuation">,</span><span class="token constant">COMMA</span><span class="token punctuation">,</span><span class="token constant">WORD</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token constant">SPACE</span><span class="token punctuation">,</span> tokens<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="lex-pl-js"><a href="#lex-pl-js" class="header-anchor">#</a> lex-pl.js</h2> <p>En este archivo se utilizan los tokens creados en tokens.js, pasándolos como parámetros a la función
nearleyLexer del módulo lexer-generator. Este crea un analizador léxico lexer que ante una entrada de texto
reconoce los tokens y les añade atributos como line, col, length, etc...</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> tokens <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./tokens.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> nearleyLexer <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;@ull-esit-pl-2122/lexer-generator-sebastian-tamayo-guzman-alu0101131108&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// (...)</span>
<span class="token keyword">let</span> lexer <span class="token operator">=</span> <span class="token function">nearleyLexer</span><span class="token punctuation">(</span>tokens<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">transform</span><span class="token operator">:</span> <span class="token punctuation">[</span>ColonTransformer<span class="token punctuation">,</span> NumberToDotsTransformer<span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Además, se pasa como parámetro un objeto de opciones que incluye una propiedad transform, cuyo valor es un
array con dos funciones. Estas se utilizarán para transformar los tokens despues de que hayan sido reconocidos.</p> <h3 id="colontransformer"><a href="#colontransformer" class="header-anchor">#</a> ColonTransformer</h3> <ul><li>Sustituye una secuencia de tokens tipo &quot;WORD{x} COLON{:}&quot; por &quot;STRING{&quot;x&quot;} COMMA{,}&quot;, de
manera que frases como &quot;x: 4&quot; sean interpretadas como &quot;'x', 4&quot;.</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">ColonTransformer</span><span class="token punctuation">(</span><span class="token parameter">tokens</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> tokens<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> oldWord <span class="token operator">=</span> tokens<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> oldColon <span class="token operator">=</span> tokens<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>oldWord<span class="token punctuation">.</span>type <span class="token operator">==</span> <span class="token string">'WORD'</span> <span class="token operator">&amp;&amp;</span> oldColon<span class="token punctuation">.</span>type <span class="token operator">==</span> <span class="token string">'COLON'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      tokens<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">'STRING'</span><span class="token punctuation">;</span>
      tokens<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>oldWord<span class="token punctuation">.</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
      tokens<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">'COMMA'</span><span class="token punctuation">;</span>
      tokens<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">','</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> tokens<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="numbertodotstransformer"><a href="#numbertodotstransformer" class="header-anchor">#</a> NumberToDotsTransformer</h3> <ul><li>Sustituye una secuencia de tokens tipo &quot;DOT{.} NUMBER{4.3}&quot; por &quot;DOT NUMBER{4} DOT{.} NUMBER{3}&quot;.
De esta manera se establece la regla de que un número decimal no puede ir precedido de un punto, resolviendo la ambiguedad.</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Substitute DOT{.} NUMBER{4.3} by DOT NUMBER{4} DOT{.} NUMBER{3}</span>
<span class="token keyword">function</span> <span class="token function">NumberToDotsTransformer</span><span class="token punctuation">(</span><span class="token parameter">tokens</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> tokens<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> oldDot <span class="token operator">=</span> tokens<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> oldDecimal <span class="token operator">=</span> tokens<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>oldDot<span class="token punctuation">.</span>type <span class="token operator">==</span> <span class="token string">'DOT'</span> <span class="token operator">&amp;&amp;</span> oldDecimal<span class="token punctuation">.</span>type <span class="token operator">==</span> <span class="token string">'NUMBER'</span> <span class="token operator">&amp;&amp;</span> oldDecimal<span class="token punctuation">.</span>value <span class="token operator">%</span> <span class="token number">1</span> <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      tokens<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> oldDot<span class="token punctuation">;</span>
      <span class="token keyword">const</span> intPart <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>oldDecimal<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
      tokens<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'NUMBER'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">value</span><span class="token operator">:</span> intPart<span class="token punctuation">,</span>
        <span class="token literal-property property">col</span><span class="token operator">:</span> oldDecimal<span class="token punctuation">.</span>col<span class="token punctuation">,</span>
        <span class="token literal-property property">lineBreaks</span><span class="token operator">:</span> oldDecimal<span class="token punctuation">.</span>lineBreaks<span class="token punctuation">,</span>
        <span class="token literal-property property">offset</span><span class="token operator">:</span> oldDecimal<span class="token punctuation">.</span>offset<span class="token punctuation">,</span>
        <span class="token literal-property property">line</span><span class="token operator">:</span> oldDecimal<span class="token punctuation">.</span>line<span class="token punctuation">,</span>
        <span class="token literal-property property">length</span><span class="token operator">:</span> intPart<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
      tokens<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> oldDot<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> decimalPart <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>oldDecimal<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      tokens<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'NUMBER'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">value</span><span class="token operator">:</span> decimalPart<span class="token punctuation">,</span>
        <span class="token literal-property property">col</span><span class="token operator">:</span> oldDecimal<span class="token punctuation">.</span>col <span class="token operator">+</span> intPart<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">,</span>
        <span class="token literal-property property">lineBreaks</span><span class="token operator">:</span> oldDecimal<span class="token punctuation">.</span>lineBreaks<span class="token punctuation">,</span>
        <span class="token literal-property property">offset</span><span class="token operator">:</span> oldDecimal<span class="token punctuation">.</span>offset<span class="token punctuation">,</span>
        <span class="token literal-property property">line</span><span class="token operator">:</span> oldDecimal<span class="token punctuation">.</span>line<span class="token punctuation">,</span>
        <span class="token literal-property property">length</span><span class="token operator">:</span> decimalPart<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> tokens<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="options-en-lexer-generator"><a href="#options-en-lexer-generator" class="header-anchor">#</a> Options en Lexer-Generator.</h3> <p>Fue necesario alterar el código del módulo Lexer Generator, para que aceptase el objeto con las opciones en las
que se pasan las funciones de transformación. De esta manera la zona cambiada queda asi:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">nearleyLexer</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">regexps<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// (...)</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token comment">// (...)</span>
    <span class="token function-variable function">reset</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span> info</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// (...)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>options <span class="token operator">&amp;&amp;</span> options<span class="token punctuation">.</span>transform<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> options<span class="token punctuation">.</span>transform <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>tokens <span class="token operator">=</span> options<span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>tokens<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> 
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>transform<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          options<span class="token punctuation">.</span>transform<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">trans</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>tokens <span class="token operator">=</span> <span class="token function">trans</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>tokens<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span> 
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// (...)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="egg-ne"><a href="#egg-ne" class="header-anchor">#</a> egg.ne</h2> <p>En este archivo se especifica la gramática del lenguaje Egg en formato nearley. Además se utilizan una
serie de funciones para construir un Abstract Syntax Tree con objetos JSON. La estructura de la gramática fue
proporcionada por el profesor, a diferencia del uso de las funciones importadas de ast-build.js.</p> <div class="language-js extra-class"><pre class="language-js"><code>@<span class="token punctuation">{</span><span class="token operator">%</span>
<span class="token keyword">const</span> lexer <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./lex-pl.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> 
        buildStringValue<span class="token punctuation">,</span> 
        buildNumberValue<span class="token punctuation">,</span> 
        buildWordApplies<span class="token punctuation">,</span>
        buildKind<span class="token punctuation">,</span>
        selector2Bracket<span class="token punctuation">,</span>
        buildArray<span class="token punctuation">,</span>
        buildObject<span class="token punctuation">,</span>
        buildDo<span class="token punctuation">,</span>
        checkNonEmpty<span class="token punctuation">,</span>
        dealWithError
<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./build-ast.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">%</span><span class="token punctuation">}</span>

@lexer lexer

program <span class="token operator">-</span><span class="token operator">&gt;</span> expression <span class="token operator">%</span><span class="token constant">EOF</span> <span class="token punctuation">{</span><span class="token operator">%</span> id <span class="token operator">%</span><span class="token punctuation">}</span>

expression <span class="token operator">-</span><span class="token operator">&gt;</span> 
      <span class="token operator">%</span><span class="token constant">STRING</span>  optProperties   <span class="token punctuation">{</span><span class="token operator">%</span> buildStringValue <span class="token operator">%</span><span class="token punctuation">}</span>
    <span class="token operator">|</span> <span class="token operator">%</span><span class="token constant">NUMBER</span>  optProperties   <span class="token punctuation">{</span><span class="token operator">%</span> buildNumberValue <span class="token operator">%</span><span class="token punctuation">}</span>
    <span class="token operator">|</span> <span class="token operator">%</span><span class="token constant">WORD</span> applies            <span class="token punctuation">{</span><span class="token operator">%</span> buildWordApplies <span class="token operator">%</span><span class="token punctuation">}</span>
    <span class="token operator">|</span> bracketExp optProperties <span class="token punctuation">{</span><span class="token operator">%</span> buildArray <span class="token operator">%</span><span class="token punctuation">}</span>
    <span class="token operator">|</span> curlyExp   optProperties <span class="token punctuation">{</span><span class="token operator">%</span> buildObject <span class="token operator">%</span><span class="token punctuation">}</span>
    <span class="token operator">|</span> <span class="token string">&quot;(&quot;</span> commaExp <span class="token string">&quot;)&quot;</span>         <span class="token punctuation">{</span><span class="token operator">%</span> buildDo <span class="token operator">%</span><span class="token punctuation">}</span>
    <span class="token operator">|</span> <span class="token operator">%</span><span class="token constant">EOF</span>                     <span class="token punctuation">{</span><span class="token operator">%</span> dealWithError <span class="token operator">%</span><span class="token punctuation">}</span>

applies <span class="token operator">-</span><span class="token operator">&gt;</span> calls  <span class="token punctuation">{</span><span class="token operator">%</span> id <span class="token operator">%</span><span class="token punctuation">}</span>
    <span class="token operator">|</span> properties  <span class="token punctuation">{</span><span class="token operator">%</span> id <span class="token operator">%</span><span class="token punctuation">}</span>
    <span class="token operator">|</span> <span class="token keyword">null</span>        <span class="token punctuation">{</span><span class="token operator">%</span> <span class="token parameter">d</span> <span class="token operator">=&gt;</span> <span class="token keyword">null</span> <span class="token operator">%</span><span class="token punctuation">}</span>

calls <span class="token operator">-</span><span class="token operator">&gt;</span>  parenExp applies          <span class="token punctuation">{</span><span class="token operator">%</span> buildKind<span class="token punctuation">[</span><span class="token string">'apply'</span><span class="token punctuation">]</span> <span class="token operator">%</span><span class="token punctuation">}</span>

properties <span class="token operator">-</span><span class="token operator">&gt;</span>  bracketExp  applies  <span class="token punctuation">{</span><span class="token operator">%</span> buildKind<span class="token punctuation">[</span><span class="token string">'property'</span><span class="token punctuation">]</span> <span class="token operator">%</span><span class="token punctuation">}</span>
    <span class="token operator">|</span> selector applies              <span class="token punctuation">{</span><span class="token operator">%</span> buildKind<span class="token punctuation">[</span><span class="token string">'property'</span><span class="token punctuation">]</span> <span class="token operator">%</span><span class="token punctuation">}</span>

parenExp   <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token string">&quot;(&quot;</span>  commaExp <span class="token string">&quot;)&quot;</span>     <span class="token punctuation">{</span><span class="token operator">%</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">[</span>lp<span class="token punctuation">,</span> commaExp<span class="token punctuation">,</span> rp<span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> commaExp <span class="token operator">%</span><span class="token punctuation">}</span>

bracketExp <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token string">&quot;[&quot;</span>  commaExp <span class="token string">&quot;]&quot;</span>     <span class="token punctuation">{</span><span class="token operator">%</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">[</span>lb<span class="token punctuation">,</span> commaExp<span class="token punctuation">,</span> rb<span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">checkNonEmpty</span><span class="token punctuation">(</span>commaExp<span class="token punctuation">)</span> <span class="token operator">%</span><span class="token punctuation">}</span>

curlyExp   <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token string">&quot;{&quot;</span>  commaExp <span class="token string">&quot;}&quot;</span>     <span class="token punctuation">{</span><span class="token operator">%</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">[</span>lc<span class="token punctuation">,</span> commaExp<span class="token punctuation">,</span> rc<span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> commaExp <span class="token operator">%</span><span class="token punctuation">}</span>

selector   <span class="token operator">-</span><span class="token operator">&gt;</span>  
     <span class="token string">&quot;.&quot;</span> <span class="token operator">%</span><span class="token constant">WORD</span>      <span class="token punctuation">{</span><span class="token operator">%</span> selector2Bracket <span class="token operator">%</span><span class="token punctuation">}</span>
   <span class="token operator">|</span> <span class="token string">&quot;.&quot;</span> <span class="token operator">%</span><span class="token constant">NUMBER</span>    <span class="token punctuation">{</span><span class="token operator">%</span> selector2Bracket <span class="token operator">%</span><span class="token punctuation">}</span>

commaExp <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">null</span>                                        <span class="token punctuation">{</span><span class="token operator">%</span> <span class="token parameter">d</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">%</span><span class="token punctuation">}</span>
   <span class="token operator">|</span> <span class="token function">expression</span> <span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span> expression <span class="token punctuation">{</span><span class="token operator">%</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">[</span>_<span class="token punctuation">,</span> e<span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> e <span class="token operator">%</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token operator">*</span>  <span class="token punctuation">{</span><span class="token operator">%</span> <span class="token parameter">d</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>d<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>d<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token punctuation">}</span>  

optProperties <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword">null</span>   <span class="token punctuation">{</span><span class="token operator">%</span> <span class="token parameter">d</span> <span class="token operator">=&gt;</span> <span class="token keyword">null</span> <span class="token operator">%</span><span class="token punctuation">}</span>
   <span class="token operator">|</span> properties         <span class="token punctuation">{</span><span class="token operator">%</span> id <span class="token operator">%</span><span class="token punctuation">}</span>
</code></pre></div><h2 id="build-ast-js"><a href="#build-ast-js" class="header-anchor">#</a> build-ast.js</h2> <p>Este archivo contiene una serie de funciones que serán utilizadas por la gramática para procesar los
tokens construyendo el AST de objetos JSON.</p> <p>De esta manera, se definen funciones como buildArray que recibe por parámetro la comma expression ([<em>1, 2, 3</em>]) y
en algunos casos un nodo de propiedades, por ejemplo si se ejecutase ['a', 'b', 'c'] <em>.length</em>. A continuación,
crea un nodo apply cuyo operador es un nodo word de nombre 'array', para representar la creación de un array. En caso
de haber propiedades, la tarea de procesalas se delega en fromListToAST.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">buildArray</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">[</span>commaExp<span class="token punctuation">,</span> properties<span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> theArray <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'apply'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">operator</span><span class="token operator">:</span> <span class="token punctuation">{</span> 
      <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'word'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">line</span><span class="token operator">:</span> commaExp<span class="token punctuation">.</span>length <span class="token operator">?</span> commaExp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>line <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token literal-property property">col</span><span class="token operator">:</span> commaExp<span class="token punctuation">.</span>length <span class="token operator">?</span> commaExp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>col <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token literal-property property">length</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'array'</span> 
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">args</span><span class="token operator">:</span> commaExp
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>properties<span class="token punctuation">)</span> <span class="token keyword">return</span> theArray<span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">fromListToAST</span><span class="token punctuation">(</span>theArray<span class="token punctuation">,</span> properties<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>O por ejemplo buildObject, que funciona de manera similar pero creando un nodo asociado a la construcción de
un objeto. Por ejemplo <em>{ x:0, y:0 }</em>. Y se contemplan las posibles propiedades del tipo { x:0, y:0 } <em>.x</em>.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">buildObject</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">[</span>commaExp<span class="token punctuation">,</span> properties<span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> theObject <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'apply'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">operator</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'word'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">line</span><span class="token operator">:</span> commaExp<span class="token punctuation">.</span>length <span class="token operator">?</span> commaExp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>line <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token literal-property property">col</span><span class="token operator">:</span> commaExp<span class="token punctuation">.</span>length <span class="token operator">?</span> commaExp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>col <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token literal-property property">length</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'object'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">args</span><span class="token operator">:</span> commaExp
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>properties<span class="token punctuation">)</span> <span class="token keyword">return</span> theObject<span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">fromListToAST</span><span class="token punctuation">(</span>theObject<span class="token punctuation">,</span> properties<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="parse-js"><a href="#parse-js" class="header-anchor">#</a> parse.js</h2> <p>Este archivo contiene las funciones principales del módulo. Estas se encargan de recibir una cadena de texto
como entrada, y parsearlas generando un AST que devuelven como resultado. Cabe resaltar que se utiliza
una estructura de try...catch para simplificar los mensajes de error que lanza nearley.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">parse</span><span class="token punctuation">(</span><span class="token parameter">p</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token comment">// From ERROR MANAGEMENT section in the task description.</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> parser <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">nearley<span class="token punctuation">.</span>Parser</span><span class="token punctuation">(</span>nearley<span class="token punctuation">.</span>Grammar<span class="token punctuation">.</span><span class="token function">fromCompiled</span><span class="token punctuation">(</span>grammar<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    parser<span class="token punctuation">.</span><span class="token function">feed</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> results <span class="token operator">=</span> parser<span class="token punctuation">.</span>results<span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>results<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Language Design Error: Ambiguous Grammar! Generated </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>results<span class="token punctuation">.</span>length<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">) ASTs</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>results<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;Unexpected end of Input error. Incomplete Egg program. Expected more input&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      process<span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">const</span> ast <span class="token operator">=</span> results<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> ast<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>e<span class="token punctuation">.</span>token<span class="token punctuation">)</span> <span class="token keyword">throw</span> e<span class="token punctuation">;</span>
    <span class="token keyword">let</span> token <span class="token operator">=</span> e<span class="token punctuation">.</span>token<span class="token punctuation">;</span>
    <span class="token keyword">let</span> message <span class="token operator">=</span> e<span class="token punctuation">.</span>message<span class="token punctuation">;</span>
    <span class="token keyword">let</span> expected <span class="token operator">=</span> message<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(?&lt;=A )&quot;.*&quot;(?= based on:)</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> newMessage <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Unexpected </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>token<span class="token punctuation">.</span>type<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> token &quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>token<span class="token punctuation">.</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; </span><span class="token template-punctuation string">`</span></span> <span class="token operator">+</span>
      <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">at line </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>token<span class="token punctuation">.</span>line<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> col </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>token<span class="token punctuation">.</span>col<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\nTokens expected: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>expected<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>newMessage<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Además, existe una función similar parseFromFile que a diferencia de parse, su parámetro de entrada es la ruta de un archivo
con código egg dentro, el cual parsea y devuelve su AST.</p> <h1 id="tests"><a href="#tests" class="header-anchor">#</a> Tests</h1> <p>Se ha seguido una estructura para los tests proporcionadas por el profesor en la que es muy facil incluir nuevos ejemplos. Tan
solo es necesario incluir en /test/src un fichero nombre.egg con código Egg y en /test/ast un fichero nombre.json con la solución esperada.</p> <p>En este caso hay 30 tests incluidos en la suite. Al ejecutarlos, se muestra la siguiente salida por pantalla.</p> <div class="language-js extra-class"><pre class="language-js"><code>usuario@ubuntu <span class="token operator">~</span><span class="token operator">/</span>Egg<span class="token operator">-</span><span class="token constant">OOP</span><span class="token operator">-</span><span class="token function">Parser</span> <span class="token punctuation">(</span>master<span class="token punctuation">)</span> $ npm test

<span class="token operator">&gt;</span> @ull<span class="token operator">-</span>esit<span class="token operator">-</span>pl<span class="token operator">-</span><span class="token number">2122</span><span class="token operator">/</span>egg<span class="token operator">-</span>oop<span class="token operator">-</span>parser<span class="token operator">-</span>sebastian<span class="token operator">-</span>tamayo<span class="token operator">-</span>guzman<span class="token operator">-</span>alu0101131108@<span class="token number">1.0</span><span class="token number">.0</span> test
<span class="token operator">&gt;</span> npm run build<span class="token punctuation">;</span> nyc <span class="token operator">--</span>reporter<span class="token operator">=</span>lcov <span class="token operator">--</span>reporter<span class="token operator">=</span>text<span class="token operator">-</span>summary <span class="token operator">--</span>report<span class="token operator">-</span>dir<span class="token operator">=</span>docs<span class="token operator">/</span>coverage <span class="token operator">-</span>o docs mocha


<span class="token operator">&gt;</span> @ull<span class="token operator">-</span>esit<span class="token operator">-</span>pl<span class="token operator">-</span><span class="token number">2122</span><span class="token operator">/</span>egg<span class="token operator">-</span>oop<span class="token operator">-</span>parser<span class="token operator">-</span>sebastian<span class="token operator">-</span>tamayo<span class="token operator">-</span>guzman<span class="token operator">-</span>alu0101131108@<span class="token number">1.0</span><span class="token number">.0</span> build
<span class="token operator">&gt;</span> nearleyc src<span class="token operator">/</span>egg<span class="token punctuation">.</span>ne <span class="token operator">-</span>o src<span class="token operator">/</span>grammar<span class="token punctuation">.</span>js



  Compiler
    ✔ array<span class="token operator">-</span>error
    ✔ array<span class="token operator">-</span>method<span class="token operator">-</span>map<span class="token operator">-</span>js<span class="token operator">-</span>chain
    ✔ array<span class="token operator">-</span>neg
    ✔ array
    ✔ curry<span class="token operator">-</span>method
    ✔ curry<span class="token operator">-</span>no<span class="token operator">-</span>method<span class="token operator">-</span>cylinder<span class="token operator">-</span>volume
    ✔ dot<span class="token operator">-</span>num
    ✔ dot<span class="token operator">-</span>obj
    ✔ dot
    ✔ <span class="token keyword">function</span><span class="token operator">-</span>length<span class="token operator">-</span>property
    ✔ <span class="token keyword">if</span>
    ✔ leftvalue
    ✔ leftvalue2
    ✔ map<span class="token operator">-</span>attributes
    ✔ map<span class="token operator">-</span>colon<span class="token operator">-</span>leftside
    ✔ map<span class="token operator">-</span>colon
    ✔ map<span class="token operator">-</span>set<span class="token operator">-</span>index
    ✔ map<span class="token operator">-</span>sub
    ✔ map
    ✔ multiple<span class="token operator">-</span>properties
    ✔ object<span class="token operator">-</span>colon<span class="token operator">-</span>selector
    ✔ plus<span class="token operator">-</span><span class="token keyword">as</span><span class="token operator">-</span>method
    ✔ scope
    ✔ set<span class="token operator">-</span>lefteval
    ✔ string<span class="token operator">-</span>apply
    ✔ string<span class="token operator">-</span>selector
    ✔ syntax

  Compiler errors
    ✔ unexpected<span class="token operator">-</span>token<span class="token operator">-</span>comma
    ✔ unexpected<span class="token operator">-</span>eof
    ✔ unexpected<span class="token operator">-</span>token<span class="token operator">-</span>word


  <span class="token number">30</span> <span class="token function">passing</span> <span class="token punctuation">(</span>87ms<span class="token punctuation">)</span>


<span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">=</span> Coverage summary <span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">=</span>
<span class="token literal-property property">Statements</span>   <span class="token operator">:</span> <span class="token number">74.26</span><span class="token operator">%</span> <span class="token punctuation">(</span> <span class="token number">127</span><span class="token operator">/</span><span class="token number">171</span> <span class="token punctuation">)</span>
<span class="token literal-property property">Branches</span>     <span class="token operator">:</span> <span class="token number">52.05</span><span class="token operator">%</span> <span class="token punctuation">(</span> <span class="token number">38</span><span class="token operator">/</span><span class="token number">73</span> <span class="token punctuation">)</span>
<span class="token literal-property property">Functions</span>    <span class="token operator">:</span> <span class="token number">86.11</span><span class="token operator">%</span> <span class="token punctuation">(</span> <span class="token number">31</span><span class="token operator">/</span><span class="token number">36</span> <span class="token punctuation">)</span>
<span class="token literal-property property">Lines</span>        <span class="token operator">:</span> <span class="token number">75</span><span class="token operator">%</span> <span class="token punctuation">(</span> <span class="token number">114</span><span class="token operator">/</span><span class="token number">152</span> <span class="token punctuation">)</span>
<span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">==</span>
</code></pre></div></div> <div class="footer">
    Made by  with ❤️
  </div></main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.f1edcd29.js" defer></script><script src="/assets/js/2.2c19e274.js" defer></script><script src="/assets/js/7.85245bc6.js" defer></script>
  </body>
</html>
