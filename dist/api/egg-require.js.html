<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: egg-require.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: egg-require.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>var fs = require('fs');
var readFile = (x) => fs.readFileSync(x, 'utf-8');
let insp = require("util").inspect;
let ins = (x) => insp(x, {depth:null});
const path = require("path");

const {specialForms, topEnv} = require("./registry.js");
const { json2AST } = require('./j2a');
let parser = require('@ull-esit-pl-2122/egg-oop-parser-sebastian-tamayo-guzman-alu0101131108');
let parse = parser.parse;

/**
 * Function to require in Egg code.
 * @param {*} args arguments
 * @param {*} env environment
 * @returns result
 */
function REQUIRE(args, env) {
  let name = args[0].value;
  if (name in REQUIRE.cache) return REQUIRE.cache[name];

  let program = readFile(name);
  let localEnv = Object.create(env);
  let tree = json2AST(parse(program));
  let result = tree.evaluate(localEnv);
  REQUIRE.cache[name] = result;
  return result;
}

REQUIRE.cache = Object.create(null);

specialForms['require'] = REQUIRE;

module.exports = REQUIRE;



</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Apply.html">Apply</a></li><li><a href="Property.html">Property</a></li><li><a href="Value.html">Value</a></li><li><a href="Word.html">Word</a></li></ul><h3>Global</h3><ul><li><a href="global.html#checkNegativeIndex">checkNegativeIndex</a></li><li><a href="global.html#eggRepl">eggRepl</a></li><li><a href="global.html#json2AST">json2AST</a></li><li><a href="global.html#REQUIRE">REQUIRE</a></li><li><a href="global.html#run">run</a></li><li><a href="global.html#runFromEVM">runFromEVM</a></li><li><a href="global.html#runFromFile">runFromFile</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.10</a> on Fri May 13 2022 00:08:17 GMT+0000 (Coordinated Universal Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
